{"title":"Centos7.3安装Mysql8","slug":"mysql-install","date":"2020-03-07T04:15:30.000Z","updated":"2020-03-07T12:55:00.180Z","comments":true,"path":"api/articles/mysql-install.json","photos":[],"link":"","excerpt":"","covers":null,"keywords":"","content":"<h2 id=\"centos7安装mysql8\">Centos7安装Mysql8</h2>\n<h3 id=\"1安装\">1.安装</h3>\n<ul>\n<li>\n<p>系统版本：Centos7</p>\n</li>\n<li>\n<p>Mysql版本：Mysql8.0</p>\n</li>\n<li>\n<p>安装方式：yum</p>\n</li>\n</ul>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">wget https://dev.mysql.com/get/mysql80-community-release-el7-3.noarch.rpm </span><br><span class=\"line\"></span><br><span class=\"line\">sudo rpm -Uvh mysql80-community-release-el7-3.noarch.rpm</span><br><span class=\"line\"></span><br><span class=\"line\">sudo yum install mysql-community-server</span><br><span class=\"line\"></span><br><span class=\"line\">sudo systemctl start mysqld.service</span><br><span class=\"line\"></span><br><span class=\"line\">sudo systemctl status mysqld.service</span><br></pre></td></tr></table></figure></div>\n<h4 id=\"切换版本\">切换版本</h4>\n<p>如果想要更换版本，可以先查看当前mysql yum repository中所有mysql版本</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum repolist all | grep mysql</span><br></pre></td></tr></table></figure></div>\n<p>切换版本</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum-config-manager --<span class=\"built_in\">disable</span> mysql80-community</span><br><span class=\"line\">sudo yum-config-manager --<span class=\"built_in\">enable</span> mysql57-community</span><br></pre></td></tr></table></figure></div>\n<h3 id=\"2修改密码\">2.修改密码</h3>\n<ol>\n<li>Mysql第一次启动后会创建超级管理员账号<code>root@localhost</code>，初始密码存储在日志文件中：</li>\n</ol>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo grep `temporary password` /var/<span class=\"built_in\">log</span>/mysqld.log</span><br></pre></td></tr></table></figure></div>\n<ol start=\"2\">\n<li>修改默认密码</li>\n</ol>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\"><span class=\"comment\"># &gt; password: &lt;输入你的初始密码&gt;</span></span><br><span class=\"line\">alter user <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> identified by <span class=\"string\">'&lt;new password&gt;'</span></span><br><span class=\"line\"><span class=\"comment\"># 注意这里的新密码需要符合策略，包含数字、大小写字母、特殊字符。</span></span><br></pre></td></tr></table></figure></div>\n<ol start=\"3\">\n<li>修改默认策略</li>\n</ol>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql &gt; <span class=\"built_in\">set</span> global validate_password_policy=0;</span><br></pre></td></tr></table></figure></div>\n<p>此时可能报错提示</p>\n<p><code>ERROR 1193 (HY000): Unknown system variable 'validate_password_policy'</code></p>\n<p>原因是<code>validate_password_policy</code>默认没有被激活，解决如下：</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql &gt; select plugin_name, plugin_status from information_schema.plugins <span class=\"built_in\">where</span> plugin_name like <span class=\"string\">'validate%'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; install plugin validate_password soname <span class=\"string\">'validate_password.so'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; mysql&gt; select plugin_name, plugin_status from information_schema.plugins <span class=\"built_in\">where</span> plugin_name like <span class=\"string\">'validate%'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">SHOW VARIABLES LIKE <span class=\"string\">'validate_password%'</span>;</span><br></pre></td></tr></table></figure></div>\n<p>首先查找plugin中是否包含validatexxx，返回empty set说明不包含，安装后即可，接着重新运行：</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql &gt; <span class=\"built_in\">set</span> global validate_password_policy=0;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; <span class=\"built_in\">set</span> global validate_password_length=8;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; alter user <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> identified by <span class=\"string\">'12345678'</span>;</span><br></pre></td></tr></table></figure></div>\n<p>修改成功</p>\n<h3 id=\"3允许用户远程访问\">3.允许用户远程访问</h3>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql &gt; CREATE USER <span class=\"string\">'test_user'</span>@<span class=\"string\">'%'</span> IDENTIFIED BY <span class=\"string\">'12345678'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; GRANT ALL ON *.* TO <span class=\"string\">'test_user'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; ALTER USER <span class=\"string\">'test_user'</span>@<span class=\"string\">'%'</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">'12345678'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql &gt; FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure></div>\n<p>完事后IDE下测试数据库连接成功！</p>\n","categories":[],"tags":[{"name":"Mysql","slug":"Mysql","count":1,"path":"api/tags/Mysql.json"}]}